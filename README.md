# phone-cleaner

أداة ويب لتنظيف أرقام الهواتف، توحيدها، واكتشاف المكرر مع تقارير واضحة. كل شيء يعمل محليًا داخل المتصفح دون إرسال أي بيانات إلى خادم.

## التشغيل محليًا

```bash
npm install
npm run dev
```

ثم افتح المتصفح على `http://localhost:3000`.

## الاختبارات

```bash
npm run test
```

## كيف تعمل عملية التطبيع (Normalization)

المحرك لا يعتمد على أي مكتبة خارجية لمعالجة الهواتف، ويطبق قواعد ثابتة:

1. تحويل الأرقام العربية إلى الغربية.
2. إزالة الفراغات والشرطات والأقواس والنقاط والرموز غير الرقمية.
3. الاحتفاظ بعلامة `+` واحدة فقط في البداية إن وجدت.
4. تحويل بادئة `00` إلى `+`.
5. إذا كان الرقم دوليًا (`+` أو `00`) فلا يتم استبدال كود الدولة.
6. إذا كان الرقم محليًا:
   - إزالة بادئة الجذع (trunk) مثل `0` عند توفرها في إعداد الدولة.
   - إضافة كود الدولة الافتراضي.
7. تحقق الطول حسب الدولة (وضع صارم) أو حسب حدود عامة (وضع مرن).

النتيجة تكون على شكل:

```
+<countryCode><nationalNumber>
```

## إضافة دولة جديدة

حدّث الملف:

- `src/features/phone-cleaner/domain/countries.json`

يجب إضافة كائن يحتوي على:

- `iso2`
- `name_en`
- `name_ar`
- `dial_code`
- `trunk_prefix` (اختياري)
- `national_number_length_min` و `national_number_length_max` (اختياري)

## إضافة إعداد مسبق (Preset)

حدّث الملف:

- `src/features/phone-cleaner/domain/presets.ts`

كل إعداد مسبق يحدد:

- الدولة الافتراضية
- قواعد الـ trunk
- أطوال الأرقام الوطنية

## الهيكلة

```
src/
  app/
  features/
    phone-cleaner/
      domain/
      ui/
      utils/
      workers/
```

- منطق المعالجة موجود في `domain` كدوال نقية قابلة للاختبار.
- الواجهة في `ui`.
- المعالجة الثقيلة في `workers` لتفادي تجميد الواجهة.

## الخصوصية

- لا يتم إرسال أي بيانات إلى أي خادم.
- كل المعالجة تتم على الجهاز.
